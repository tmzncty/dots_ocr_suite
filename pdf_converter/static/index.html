<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF 轉 DOCX 轉換器</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="style_batch.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>📄 PDF 轉 DOCX 轉換器</h1>
            <div class="subtitle">由 Dots OCR 提供支援 - 使用 AI 將 PDF 文件轉換為可編輯的 DOCX</div>
            
            <div class="settings-panel" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 8px; display: inline-block;">
                <label for="concurrencyInput">並發圖片數 (1-32): </label>
                <input type="number" id="concurrencyInput" min="1" max="32" value="32" style="width: 60px; padding: 4px;">
                <button id="saveSettingsBtn" class="small secondary">儲存設定</button>
            </div>
        </header>
        
        <div class="upload-section">
            <div class="file-drop-zone" id="dropZone">
                <div class="icon">📤</div>
                <div class="text">
                    <strong>點擊上傳</strong> 或拖放文件<br>
                    支援多個 PDF 文件
                </div>
            </div>
            <input type="file" id="fileInput" accept="application/pdf" multiple style="display: none;">
            
            <div class="options">
                <div class="option">
                    <input type="radio" id="processSingle" name="processMode" value="single">
                    <label for="processSingle">僅處理第一頁</label>
                </div>
                <div class="option">
                    <input type="radio" id="processAll" name="processMode" value="all" checked>
                    <label for="processAll">處理整份 PDF</label>
                </div>
            </div>
            
            <div class="batch-controls" style="margin-top: 20px; display: none;" id="batchControls">
                <button id="startBatchBtn" class="primary">🚀 開始批量處理</button>
                <button id="downloadBatchBtn" class="secondary" disabled>📦 下載已選項目</button>
                <span id="serverInfo" style="margin-left: 10px; font-size: 0.9em; color: #666;"></span>
            </div>
        </div>
        
        <div class="file-list-section" id="fileListSection" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <h3 style="margin: 0;">文件隊列 / 歷史記錄</h3>
                <button class="small secondary" onclick="loadHistory()">🔄 刷新列表</button>
            </div>
            <div class="file-list-header">
                <div class="col-select"><input type="checkbox" id="selectAll"></div>
                <div class="col-name">檔名</div>
                <div class="col-status">狀態</div>
                <div class="col-progress">進度</div>
                <div class="col-action">操作</div>
            </div>
            <div id="fileListContainer"></div>
        </div>
        
        <div class="progress-section" id="progressSection" style="display: none;">
            <!-- Detailed progress for selected file -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 id="detailTitle">處理詳情</h3>
                <div id="detailActions"></div>
            </div>
            
            <!-- 拆图进度 -->
            <div class="progress-item">
                <div class="progress-label">
                    <span>📄 提取 PDF 頁面</span>
                    <span id="extractStatus">等待中...</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="extractProgress" style="width: 0%">0%</div>
                </div>
            </div>
            
            <!-- OCR进度 -->
            <div class="progress-item">
                <div class="progress-label">
                    <span>🔍 OCR 識別中</span>
                    <span id="ocrStatus">等待中...</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="ocrProgress" style="width: 0%">0%</div>
                </div>
            </div>
            
            <!-- 生成文档进度 -->
            <div class="progress-item">
                <div class="progress-label">
                    <span>📝 生成文檔中</span>
                    <span id="generateStatus">等待中...</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="generateProgress" style="width: 0%">0%</div>
                </div>
            </div>
            
            <!-- 日志输出 -->
            <div class="log-section">
                <h4>📋 處理日誌</h4>
                <div class="log-output" id="logOutput"></div>
            </div>
        </div>
        
        <div class="result-section" id="resultSection" style="display: none;">
            <!-- Single file result actions -->
        </div>
        
        <div class="existing-files" id="existingFiles" style="display:none;">
            <h3>Previously Converted Files</h3>
            <div id="fileList"></div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
